---
title: Описание API устройств записи SpRecord M/MT
description: Список функций и передаваемых параметров
published: true
date: 2022-06-16T10:03:23.357Z
tags: sprecord mt, api
editor: markdown
dateCreated: 2022-06-16T10:03:23.357Z
---

# Общая информация
Устройства записи ```SpRecord M/MT``` позволяют взаимодействовать с ними посредством HTTP API-запросов. Некоторые запросы (исходящие) делает само устройство при наступлении определённых событий (запрос направляется на указанный в настройках сервер), другие же запросы (входящие) необходимо направлять на само устройство для получения от него оределённой информации.

Исходящие запросы:
- Запрос с информацией о поступившем входящем звонке. Устройство отправляет его в момент прихода вызова по телефонной линии.
- Запрос с информацией о номере звонящего абонента. Устройство отправляет его в момент определения номера звонящего.
- Запрос с информайией об окончании разговора. Устройство отправляет его в момент окончания телефонного разговора (когда кладётся трубка).

Входящие запросы:
- Запрос статуса устройства.
- Запрос файла записи по идентификатору.
- Запрос для включения записи на канале.
- Запрос для выключения записи на канале.

# Включение API
По умолчанию API выключено в настройках. Для того, чтобы его задействовать, в веб-интерфейсе устройства откройте раздел настроек (нажав на кнопку с шестерёнкой), и на вкладке ```Программа``` установите галку ```Включить API```, также укажите адрес, на который требуется отправлять информацию. При необходимости также установите галки ```Номер АОН``` и ```Окончание разговора```, в этом случае устройство будет отправлять соответствующие запросы на указанный адрес.
![enable_api.png](/m-mt/enable_api.png)

# Исходящие запросы
> Внимание! Исходящие запросы с информацией о входящих звонках будут отправляться только в том случае, если порт устройства работает в режиме "Телефонная линия".
{.is-info}
## Запрос с информацией о входящем вызове
**Тип запроса**: HTTP POST.
**Передаваемые параметры**:
`msg` - код запроса, всегда 1;
`datetime` - дата/время поступления вызова в формате ГГГГ-мм-дд чч:мм:сс;
`number` - телефонный номер звонящего, если определился;
`channel_hard_name` - аппаратное имя канала устройства, на котором зафиксирован вызов;
`channel_user_name` - пользовательское имя канала устройства, на котором зафиксирован вызов.
## Запрос с информацией об окончании разговора
**Тип запроса**: HTTP POST.
**Передаваемые параметры**:
`msg` - код запроса, всегда 2;
`datetime` - дата/время окончания вызова в формате ГГГГ-мм-дд чч:мм:сс;
`phone_from` - телефонный номер звонящего, если определился;
`channel_hard_name` - аппаратное имя канала устройства, на котором зафиксирован вызов;
`channel_user_name` - пользовательское имя канала устройства, на котором зафиксирован вызов;
`call_type` - тип звонка;
`duration_sec` - продолжительность разговора в секундах;
`idr` - идентификатор записи.
# Входящие запросы
## Запрос статуса устройства
**Тип запроса**: HTTP GET.
**Путь**: http://x.x.x.x/api/get_status (где x.x.x.x - IP-адрес устройства ```SpRecord M/MT```).